apiVersion: config.istio.io/v1alpha2
kind: RouteRule
metadata:
  name: inventory-lb
spec:
  destination:
    name: inventory
  precedence: 1
  route:
  - labels:
      version: v1
    weight: 100
    httpReqTimeout:
        simpleTimeout:
          timeout: 1s
  - labels:
      version: v2
    weight: 0
    httpReqTimeout:
        simpleTimeout:
          timeout: 1s
  - labels:
      version: v3
      httpReqTimeout:
          simpleTimeout:
            timeout: 1s
    weight: 0
---
apiVersion: config.istio.io/v1alpha2
kind: RouteRule
metadata:
  name: basket-lb
spec:
  destination:
    name: basket
  precedence: 1
  route:
  - labels:
      version: v1
    weight: 100
---
apiVersion: config.istio.io/v1alpha2
kind: RouteRule
metadata:
  name: user-lb
spec:
  destination:
    name: user
  precedence: 1
  route:
  - labels:
      version: v1
    weight: 100